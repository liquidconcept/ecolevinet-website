

<section id='records'>
  <% items = [['Toutes les sections',0]] + @event_sections.collect{ |s| [s.title, s.id] }  %>
  <%= select_tag 'section', options_for_select(items) %>
  <%= render :partial => 'records' %>
</section>
<aside id='actions'>
  <%= render :partial => 'actions' %>
</aside>
<%= render :partial => '/shared/admin/make_sortable',
            :locals => {
              :tree => false
} if !searching? and Admin::EventsController.sortable? and Event.count > 2 %>

<% content_for :javascripts do %>
  <script>
    $(document).ready(function(){

      function load_select_section () {
        var section_selection, current_section, pathname;
           section_selection = '';
           current_section = '';
           pathname = '';
           current_section = window.location.search.split('=')[1];
           pathname = window.location.pathname;

        if ( window.location.search.split('=')[0] == '?section_id' ){
          $("select#section option[value="+ current_section + "]").attr("selected", true);
        };


        $('select#section').change(function () {
          section_selection = $("select#section option:selected").attr('value');
          if (section_selection == current_section) {
            return true;
          };
          if (section_selection == 0) {
             window.location = pathname;
          }
          else {
            window.location = pathname + '?section_id=' + section_selection;
          };
       });
       }
       load_select_section();
    });
  </script>
<% end %>
