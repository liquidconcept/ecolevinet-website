<% articles_rendered = false %>
<% page.children.each_with_index do |child,i| %>

  <% case child.data_type %>
  <% when "news" %>
    <%= render :partial => 'news',       :locals => {:section => page.section, :odd => i % 2 == 0 }  if page.section.news.any? %>
  <% when "events" %>
    <%= render :partial => 'calendar',   :locals => {:section => page.section, :odd => i % 2 == 0 }  if page.section.events.any? %>
  <% when "portfolio" %>
    <%= render :partial => 'portfolio',  :locals => {:section => page.section, :odd => i % 2 == 0 }  if page.section.portfolio_entries.any? %>
  <% else %>
    <%= render :partial => 'page',       :locals => {:section => page.section, :odd => i % 2 == 0 }  unless articles_rendered  %>
    <% articles_rendered = true %>
  <% end %>
<% end %>
